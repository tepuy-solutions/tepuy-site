<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Retirement Goal Calculator | Tepuy Solutions</title>

  <!-- brand assets -->
  <link rel="icon" type="image/png" href="/img/tepuy_logo.png"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap">
  <link rel="stylesheet" href="/css/tepuy.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <!-- NAVBAR (same on every page) -->
  <header class="navbar">
    <div class="logo-title">
      <img src="/img/tepuy_logo.png" class="logo" alt="Tepuy logo">
      <strong>Tepuy Solutions</strong>
    </div>
    <nav>
      <a href="/">Home</a>
      <a href="/calculators/property_vs_shares.html">Rent vs Buy</a>
      <a href="/calculators/retirement.html">Retirement</a>
      <a href="/store/">Store</a>
      <a href="/blog/">Blog</a>
    </nav>
  </header>

  <!-- MAIN CALCULATOR -->
  <section class="section">
    <h1 style="text-align:center">Retirement Goal Calculator</h1>

    <!-- ► input form  --------------------------------------------------- -->
    <form id="retirementForm" class="card" style="max-width:700px;margin:auto">
      <label>Current Age
        <input type="number" id="currentAge" value="45" min="0">
      </label>

      <label>Current Capital to Invest ($)
        <input type="text" id="currentCapital" value="100,000">
      </label>

      <label>Expected Annual Return (%)
        <input type="number" id="rateOfReturn" value="7" step="0.1">
      </label>

      <label>Expected Inflation Rate (%)
        <input type="number" id="inflationRate" value="2.5" step="0.1">
      </label>

      <label>Withdrawal Rate (% of capital annually)<br>
        <small id="suggestedWithdrawal">Suggested: calculating…</small>
        <input type="number" id="withdrawalRate" value="4.4" step="0.1">
      </label>

      <label>Monthly Contributions (today $)
        <input type="text" id="monthlySavings" value="1,000">
      </label>

      <label>Target Monthly Income (today $)
        <input type="text" id="desiredMonthlyIncome" value="4,000">
      </label>

      <button type="button" class="primary" style="width:100%" onclick="calculateRetirement()">
        Calculate
      </button>
    </form>

    <!-- ► disclaimer & messages ---------------------------------------- -->
    <p class="disclaimer" style="max-width:700px;margin:25px auto">
      <strong>Disclaimer:</strong> This tool is educational only and does not constitute financial advice.
      Consult a licensed adviser for personalised recommendations.
    </p>

    <div id="result" class="result" style="display:none;max-width:700px;margin:auto"></div>

    <!-- ► projection table --------------------------------------------- -->
    <div class="table-container" style="max-width:700px;margin:auto">
      <table id="projectionTable" style="display:none">
        <thead>
          <tr>
            <th>Age</th>
            <th>Capital ($)</th>
            <th>Infl-Adj Goal ($)</th>
            <th>Annual Contribution ($)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <footer>&copy; 2025 Tepuy Solutions</footer>

  <!-- ► JS logic (kept the same, just tidied) --------------------------- -->
  <script>
    /* --- Helper: format commas as you type ---------------------------- */
    ['currentCapital','monthlySavings','desiredMonthlyIncome'].forEach(id=>{
      const el=document.getElementById(id);
      el.addEventListener('input',()=>{
        const n = el.value.replace(/,/g,'');
        if(!isNaN(n)&&n!==''){ el.value = Number(n).toLocaleString(); }
      });
    });

    /* --- Suggest a safe withdrawal rate ------------------------------- */
    function suggestWithdrawalRate(){
      const r=parseFloat(rateOfReturn.value)/100,
            i=parseFloat(inflationRate.value)/100;
      const w=((1+r)/(1+i)-1)*100;
      if(isFinite(w)&&w>0){ withdrawalRate.value=w.toFixed(1);
        suggestedWithdrawal.textContent=`Suggested: ${w.toFixed(1)}%`; }
    }
    rateOfReturn.addEventListener('input',suggestWithdrawalRate);
    inflationRate.addEventListener('input',suggestWithdrawalRate);
    document.addEventListener('DOMContentLoaded',suggestWithdrawalRate);

    /* --- Core calculation --------------------------------------------- */
    function calculateRetirement(){
      const age          = +currentAge.value,
            capitalNow   = +currentCapital.value.replace(/,/g,'')||0,
            r            = (+rateOfReturn.value)/100,
            infl         = (+inflationRate.value)/100,
            wr           = (+withdrawalRate.value)/100,
            contribMonth = +monthlySavings.value.replace(/,/g,'')||0,
            incomeMonth  = +desiredMonthlyIncome.value.replace(/,/g,'')||0;

      if(!(age>=0&&age<120)){ alert('Enter a valid age (0-120)'); return; }

      const targetToday = (incomeMonth*12)/wr;
      let cap = capitalNow, years = 0, rows='';

      const tbody = projectionTable.querySelector('tbody');
      tbody.innerHTML='';

      while(years<100){
        const targetAdj = targetToday*Math.pow(1+infl,years);
        const annualCon = contribMonth*12*Math.pow(1+infl,years);

        rows +=`
          <tr>
            <td>${age+years}</td>
            <td>$${Math.round(cap).toLocaleString()}</td>
            <td>$${Math.round(targetAdj).toLocaleString()}</td>
            <td>$${Math.round(annualCon).toLocaleString()}</td>
          </tr>`;

        if(cap>=targetAdj) break;
        cap = cap*(1+r)+annualCon;
        years++;
      }
      tbody.innerHTML=rows;
      projectionTable.style.display='table';

      result.className='result';
      result.style.display='block';
      result.textContent = years<100
        ? `Goal reached at age ${age+years} (in ${years} years) with ≈ $${Math.round(cap).toLocaleString()}`
        : `Goal not reachable within 100 years under current assumptions.`;
    }
  </script>
</body>
</html>
